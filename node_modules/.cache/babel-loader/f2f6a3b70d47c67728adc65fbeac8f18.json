{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport { isValidElement, useEffect, useMemo } from 'react';\nimport inflection from 'inflection';\nimport { useLocation } from 'react-router-dom';\nimport { useSelector } from 'react-redux';\nimport get from 'lodash/get';\nimport { useCheckMinimumRequiredProps } from './checkMinimumRequiredProps';\nimport useListParams from './useListParams';\nimport useRecordSelection from './useRecordSelection';\nimport useTranslate from '../i18n/useTranslate';\nimport useNotify from '../sideEffect/useNotify';\nimport useGetList from '../dataProvider/useGetList';\nimport { SORT_ASC } from '../reducer/admin/resource/list/queryReducer';\nimport { CRUD_GET_LIST } from '../actions';\nimport defaultExporter from '../export/defaultExporter';\nimport { useResourceContext } from '../core';\nvar defaultSort = {\n  field: 'id',\n  order: SORT_ASC\n};\nvar defaultData = {};\n/**\n * Prepare data for the List view\n *\n * @param {Object} props The props passed to the List component.\n *\n * @return {Object} controllerProps Fetched and computed data for the List view\n *\n * @example\n *\n * import { useListController } from 'react-admin';\n * import ListView from './ListView';\n *\n * const MyList = props => {\n *     const controllerProps = useListController(props);\n *     return <ListView {...controllerProps} {...props} />;\n * }\n */\n\nvar useListController = function (props) {\n  useCheckMinimumRequiredProps('List', ['basePath', 'resource'], props);\n  var basePath = props.basePath,\n      _a = props.exporter,\n      exporter = _a === void 0 ? defaultExporter : _a,\n      filterDefaultValues = props.filterDefaultValues,\n      hasCreate = props.hasCreate,\n      _b = props.sort,\n      sort = _b === void 0 ? defaultSort : _b,\n      _c = props.perPage,\n      perPage = _c === void 0 ? 10 : _c,\n      filter = props.filter,\n      _d = props.debounce,\n      debounce = _d === void 0 ? 500 : _d;\n  var resource = useResourceContext(props);\n\n  if (filter && isValidElement(filter)) {\n    throw new Error('<List> received a React element as `filter` props. If you intended to set the list filter elements, use the `filters` (with an s) prop instead. The `filter` prop is internal and should not be set by the developer.');\n  }\n\n  var location = useLocation();\n  var translate = useTranslate();\n  var notify = useNotify();\n\n  var _e = useListParams({\n    resource: resource,\n    location: location,\n    filterDefaultValues: filterDefaultValues,\n    sort: sort,\n    perPage: perPage,\n    debounce: debounce\n  }),\n      query = _e[0],\n      queryModifiers = _e[1];\n\n  var _f = useRecordSelection(resource),\n      selectedIds = _f[0],\n      selectionModifiers = _f[1];\n  /**\n   * We want the list of ids to be always available for optimistic rendering,\n   * and therefore we need a custom action (CRUD_GET_LIST) that will be used.\n   */\n\n\n  var _g = useGetList(resource, {\n    page: query.page,\n    perPage: query.perPage\n  }, {\n    field: query.sort,\n    order: query.order\n  }, __assign(__assign({}, query.filter), filter), {\n    action: CRUD_GET_LIST,\n    onFailure: function (error) {\n      return notify(typeof error === 'string' ? error : error.message || 'ra.notification.http_error', 'warning', {\n        _: typeof error === 'string' ? error : error && error.message ? error.message : undefined\n      });\n    }\n  }),\n      ids = _g.ids,\n      total = _g.total,\n      error = _g.error,\n      loading = _g.loading,\n      loaded = _g.loaded;\n\n  var data = useSelector(function (state) {\n    return get(state.admin.resources, [resource, 'data'], defaultData);\n  }); // When the user changes the page/sort/filter, this controller runs the\n  // useGetList hook again. While the result of this new call is loading,\n  // the ids and total are empty. To avoid rendering an empty list at that\n  // moment, we override the ids and total with the latest loaded ones.\n\n  var defaultIds = useSelector(function (state) {\n    return get(state.admin.resources, [resource, 'list', 'ids'], []);\n  });\n  var defaultTotal = useSelector(function (state) {\n    return get(state.admin.resources, [resource, 'list', 'total']);\n  }); // Since the total can be empty during the loading phase\n  // We need to override that total with the latest loaded one\n  // This way, the useEffect bellow won't reset the page to 1\n\n  var finalTotal = typeof total === 'undefined' ? defaultTotal : total;\n  var finalIds = typeof total === 'undefined' ? defaultIds : ids;\n  var totalPages = useMemo(function () {\n    return Math.ceil(finalTotal / query.perPage) || 1;\n  }, [query.perPage, finalTotal]);\n  useEffect(function () {\n    if (query.page <= 0 || !loading && query.page > 1 && (finalIds || []).length === 0) {\n      // Query for a page that doesn't exist, set page to 1\n      queryModifiers.setPage(1);\n    } else if (!loading && query.page > totalPages) {\n      // Query for a page out of bounds, set page to the last existing page\n      // It occurs when deleting the last element of the last page\n      queryModifiers.setPage(totalPages);\n    }\n  }, [loading, query.page, finalIds, queryModifiers, total, totalPages, defaultIds]);\n  var currentSort = useMemo(function () {\n    return {\n      field: query.sort,\n      order: query.order\n    };\n  }, [query.sort, query.order]);\n  var resourceName = translate(\"resources.\" + resource + \".name\", {\n    smart_count: 2,\n    _: inflection.humanize(inflection.pluralize(resource))\n  });\n  var defaultTitle = translate('ra.page.list', {\n    name: resourceName\n  });\n  return {\n    basePath: basePath,\n    currentSort: currentSort,\n    data: data,\n    defaultTitle: defaultTitle,\n    displayedFilters: query.displayedFilters,\n    error: error,\n    exporter: exporter,\n    filter: filter,\n    filterValues: query.filterValues,\n    hasCreate: hasCreate,\n    hideFilter: queryModifiers.hideFilter,\n    ids: finalIds,\n    loaded: loaded || defaultIds.length > 0,\n    loading: loading,\n    onSelect: selectionModifiers.select,\n    onToggleItem: selectionModifiers.toggle,\n    onUnselectItems: selectionModifiers.clearSelection,\n    page: query.page,\n    perPage: query.perPage,\n    resource: resource,\n    selectedIds: selectedIds,\n    setFilters: queryModifiers.setFilters,\n    setPage: queryModifiers.setPage,\n    setPerPage: queryModifiers.setPerPage,\n    setSort: queryModifiers.setSort,\n    showFilter: queryModifiers.showFilter,\n    total: finalTotal\n  };\n};\n\nexport var injectedProps = ['basePath', 'currentSort', 'data', 'defaultTitle', 'displayedFilters', 'error', 'exporter', 'filterValues', 'hasCreate', 'hideFilter', 'ids', 'loading', 'loaded', 'onSelect', 'onToggleItem', 'onUnselectItems', 'page', 'perPage', 'refresh', 'resource', 'selectedIds', 'setFilters', 'setPage', 'setPerPage', 'setSort', 'showFilter', 'total', 'totalPages', 'version'];\n/**\n * Select the props injected by the useListController hook\n * to be passed to the List children need\n * This is an implementation of pick()\n */\n\nexport var getListControllerProps = function (props) {\n  return injectedProps.reduce(function (acc, key) {\n    var _a;\n\n    return __assign(__assign({}, acc), (_a = {}, _a[key] = props[key], _a));\n  }, {});\n};\n/**\n * Select the props not injected by the useListController hook\n * to be used inside the List children to sanitize props injected by List\n * This is an implementation of omit()\n */\n\nexport var sanitizeListRestProps = function (props) {\n  return Object.keys(props).filter(function (propName) {\n    return !injectedProps.includes(propName);\n  }).reduce(function (acc, key) {\n    var _a;\n\n    return __assign(__assign({}, acc), (_a = {}, _a[key] = props[key], _a));\n  }, {});\n};\nexport default useListController;","map":{"version":3,"sources":["F:/TTNM/admin3/node_modules/ra-core/esm/controller/useListController.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","isValidElement","useEffect","useMemo","inflection","useLocation","useSelector","get","useCheckMinimumRequiredProps","useListParams","useRecordSelection","useTranslate","useNotify","useGetList","SORT_ASC","CRUD_GET_LIST","defaultExporter","useResourceContext","defaultSort","field","order","defaultData","useListController","props","basePath","_a","exporter","filterDefaultValues","hasCreate","_b","sort","_c","perPage","filter","_d","debounce","resource","Error","location","translate","notify","_e","query","queryModifiers","_f","selectedIds","selectionModifiers","_g","page","action","onFailure","error","message","_","undefined","ids","total","loading","loaded","data","state","admin","resources","defaultIds","defaultTotal","finalTotal","finalIds","totalPages","Math","ceil","setPage","currentSort","resourceName","smart_count","humanize","pluralize","defaultTitle","name","displayedFilters","filterValues","hideFilter","onSelect","select","onToggleItem","toggle","onUnselectItems","clearSelection","setFilters","setPerPage","setSort","showFilter","injectedProps","getListControllerProps","reduce","acc","key","sanitizeListRestProps","keys","propName","includes"],"mappings":"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","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { isValidElement, useEffect, useMemo } from 'react';\nimport inflection from 'inflection';\nimport { useLocation } from 'react-router-dom';\nimport { useSelector } from 'react-redux';\nimport get from 'lodash/get';\nimport { useCheckMinimumRequiredProps } from './checkMinimumRequiredProps';\nimport useListParams from './useListParams';\nimport useRecordSelection from './useRecordSelection';\nimport useTranslate from '../i18n/useTranslate';\nimport useNotify from '../sideEffect/useNotify';\nimport useGetList from '../dataProvider/useGetList';\nimport { SORT_ASC } from '../reducer/admin/resource/list/queryReducer';\nimport { CRUD_GET_LIST } from '../actions';\nimport defaultExporter from '../export/defaultExporter';\nimport { useResourceContext } from '../core';\nvar defaultSort = {\n    field: 'id',\n    order: SORT_ASC,\n};\nvar defaultData = {};\n/**\n * Prepare data for the List view\n *\n * @param {Object} props The props passed to the List component.\n *\n * @return {Object} controllerProps Fetched and computed data for the List view\n *\n * @example\n *\n * import { useListController } from 'react-admin';\n * import ListView from './ListView';\n *\n * const MyList = props => {\n *     const controllerProps = useListController(props);\n *     return <ListView {...controllerProps} {...props} />;\n * }\n */\nvar useListController = function (props) {\n    useCheckMinimumRequiredProps('List', ['basePath', 'resource'], props);\n    var basePath = props.basePath, _a = props.exporter, exporter = _a === void 0 ? defaultExporter : _a, filterDefaultValues = props.filterDefaultValues, hasCreate = props.hasCreate, _b = props.sort, sort = _b === void 0 ? defaultSort : _b, _c = props.perPage, perPage = _c === void 0 ? 10 : _c, filter = props.filter, _d = props.debounce, debounce = _d === void 0 ? 500 : _d;\n    var resource = useResourceContext(props);\n    if (filter && isValidElement(filter)) {\n        throw new Error('<List> received a React element as `filter` props. If you intended to set the list filter elements, use the `filters` (with an s) prop instead. The `filter` prop is internal and should not be set by the developer.');\n    }\n    var location = useLocation();\n    var translate = useTranslate();\n    var notify = useNotify();\n    var _e = useListParams({\n        resource: resource,\n        location: location,\n        filterDefaultValues: filterDefaultValues,\n        sort: sort,\n        perPage: perPage,\n        debounce: debounce,\n    }), query = _e[0], queryModifiers = _e[1];\n    var _f = useRecordSelection(resource), selectedIds = _f[0], selectionModifiers = _f[1];\n    /**\n     * We want the list of ids to be always available for optimistic rendering,\n     * and therefore we need a custom action (CRUD_GET_LIST) that will be used.\n     */\n    var _g = useGetList(resource, {\n        page: query.page,\n        perPage: query.perPage,\n    }, { field: query.sort, order: query.order }, __assign(__assign({}, query.filter), filter), {\n        action: CRUD_GET_LIST,\n        onFailure: function (error) {\n            return notify(typeof error === 'string'\n                ? error\n                : error.message || 'ra.notification.http_error', 'warning', {\n                _: typeof error === 'string'\n                    ? error\n                    : error && error.message\n                        ? error.message\n                        : undefined,\n            });\n        },\n    }), ids = _g.ids, total = _g.total, error = _g.error, loading = _g.loading, loaded = _g.loaded;\n    var data = useSelector(function (state) {\n        return get(state.admin.resources, [resource, 'data'], defaultData);\n    });\n    // When the user changes the page/sort/filter, this controller runs the\n    // useGetList hook again. While the result of this new call is loading,\n    // the ids and total are empty. To avoid rendering an empty list at that\n    // moment, we override the ids and total with the latest loaded ones.\n    var defaultIds = useSelector(function (state) {\n        return get(state.admin.resources, [resource, 'list', 'ids'], []);\n    });\n    var defaultTotal = useSelector(function (state) {\n        return get(state.admin.resources, [resource, 'list', 'total']);\n    });\n    // Since the total can be empty during the loading phase\n    // We need to override that total with the latest loaded one\n    // This way, the useEffect bellow won't reset the page to 1\n    var finalTotal = typeof total === 'undefined' ? defaultTotal : total;\n    var finalIds = typeof total === 'undefined' ? defaultIds : ids;\n    var totalPages = useMemo(function () {\n        return Math.ceil(finalTotal / query.perPage) || 1;\n    }, [query.perPage, finalTotal]);\n    useEffect(function () {\n        if (query.page <= 0 ||\n            (!loading && query.page > 1 && (finalIds || []).length === 0)) {\n            // Query for a page that doesn't exist, set page to 1\n            queryModifiers.setPage(1);\n        }\n        else if (!loading && query.page > totalPages) {\n            // Query for a page out of bounds, set page to the last existing page\n            // It occurs when deleting the last element of the last page\n            queryModifiers.setPage(totalPages);\n        }\n    }, [\n        loading,\n        query.page,\n        finalIds,\n        queryModifiers,\n        total,\n        totalPages,\n        defaultIds,\n    ]);\n    var currentSort = useMemo(function () { return ({\n        field: query.sort,\n        order: query.order,\n    }); }, [query.sort, query.order]);\n    var resourceName = translate(\"resources.\" + resource + \".name\", {\n        smart_count: 2,\n        _: inflection.humanize(inflection.pluralize(resource)),\n    });\n    var defaultTitle = translate('ra.page.list', {\n        name: resourceName,\n    });\n    return {\n        basePath: basePath,\n        currentSort: currentSort,\n        data: data,\n        defaultTitle: defaultTitle,\n        displayedFilters: query.displayedFilters,\n        error: error,\n        exporter: exporter,\n        filter: filter,\n        filterValues: query.filterValues,\n        hasCreate: hasCreate,\n        hideFilter: queryModifiers.hideFilter,\n        ids: finalIds,\n        loaded: loaded || defaultIds.length > 0,\n        loading: loading,\n        onSelect: selectionModifiers.select,\n        onToggleItem: selectionModifiers.toggle,\n        onUnselectItems: selectionModifiers.clearSelection,\n        page: query.page,\n        perPage: query.perPage,\n        resource: resource,\n        selectedIds: selectedIds,\n        setFilters: queryModifiers.setFilters,\n        setPage: queryModifiers.setPage,\n        setPerPage: queryModifiers.setPerPage,\n        setSort: queryModifiers.setSort,\n        showFilter: queryModifiers.showFilter,\n        total: finalTotal,\n    };\n};\nexport var injectedProps = [\n    'basePath',\n    'currentSort',\n    'data',\n    'defaultTitle',\n    'displayedFilters',\n    'error',\n    'exporter',\n    'filterValues',\n    'hasCreate',\n    'hideFilter',\n    'ids',\n    'loading',\n    'loaded',\n    'onSelect',\n    'onToggleItem',\n    'onUnselectItems',\n    'page',\n    'perPage',\n    'refresh',\n    'resource',\n    'selectedIds',\n    'setFilters',\n    'setPage',\n    'setPerPage',\n    'setSort',\n    'showFilter',\n    'total',\n    'totalPages',\n    'version',\n];\n/**\n * Select the props injected by the useListController hook\n * to be passed to the List children need\n * This is an implementation of pick()\n */\nexport var getListControllerProps = function (props) {\n    return injectedProps.reduce(function (acc, key) {\n        var _a;\n        return (__assign(__assign({}, acc), (_a = {}, _a[key] = props[key], _a)));\n    }, {});\n};\n/**\n * Select the props not injected by the useListController hook\n * to be used inside the List children to sanitize props injected by List\n * This is an implementation of omit()\n */\nexport var sanitizeListRestProps = function (props) {\n    return Object.keys(props)\n        .filter(function (propName) { return !injectedProps.includes(propName); })\n        .reduce(function (acc, key) {\n        var _a;\n        return (__assign(__assign({}, acc), (_a = {}, _a[key] = props[key], _a)));\n    }, {});\n};\nexport default useListController;\n"]},"metadata":{},"sourceType":"module"}